


 ########## RUNNING subset_and_output for 2018 ##########

Opening input file:   /home/rtullis/orchid_initiative/postpartum_larc/raw/csv_HCAIPDD_04-09-2024_1143_2018.csv

Variables of interest are:
['oshpd_id', 'data_id', 'pat_id', 'agyradm', 'sex', 'ethncty', 'race1', 'race_grp', 'pls_abbr', 'patcnty', 'patzip', 'admtdate', 'dschdate', 'dsch_yr', 'los', 'srcpo_ns', 'srcroute_ns', 'admtype_ns', 'disp', 'pay_cat', 'pay_type', 'pay_plan', 'charge', 'MSDRG', 'diag_p', 'poa_p', 'proc_p', 'odiag1', 'odiag2', 'odiag3', 'odiag4', 'odiag5', 'odiag6', 'odiag7', 'odiag8', 'odiag9', 'odiag10', 'odiag11', 'odiag12', 'odiag13', 'odiag14', 'odiag15', 'odiag16', 'odiag17', 'odiag18', 'odiag19', 'odiag20', 'odiag21', 'odiag22', 'odiag23', 'odiag24', 'oproc1', 'oproc2', 'oproc3', 'oproc4', 'oproc5', 'oproc6', 'oproc7', 'oproc8', 'oproc9', 'oproc10', 'oproc11', 'oproc12', 'oproc13', 'oproc14', 'oproc15', 'oproc16', 'oproc17', 'oproc18', 'oproc19', 'oproc20', 'oproc21', 'oproc22', 'oproc23', 'oproc24']

Check to see if headerrow_subset and 
                         variables_keep match.
--> Good.  The headerrow_subset contains 
                             the expected variables

Here are the indices for selected variables:   [1, 5, 6, 11, 16, 17, 18, 29, 30, 35, 38, 40, 42, 43, 44, 46, 50, 51, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 103, 106, 109, 112, 115, 118, 121, 124, 127, 130, 133, 136, 139, 142, 145, 148, 151, 154, 157, 160, 163, 166, 169, 172, 201, 202, 206, 207, 208, 209, 211, 212]

And here are the corresponding variables selected:  
['oshpd_id', 'data_id', 'pat_id', 'agyradm', 'sex', 'ethncty', 'race1', 'race_grp', 'admtdate', 'dschdate', 'dsch_yr', 'los', 'srcpo_ns', 'srcroute_ns', 'admtype_ns', 'MSDRG', 'diag_p', 'poa_p', 'odiag1', 'odiag2', 'odiag3', 'odiag4', 'odiag5', 'odiag6', 'odiag7', 'odiag8', 'odiag9', 'odiag10', 'odiag11', 'odiag12', 'odiag13', 'odiag14', 'odiag15', 'odiag16', 'odiag17', 'odiag18', 'odiag19', 'odiag20', 'odiag21', 'odiag22', 'odiag23', 'odiag24', 'proc_p', 'oproc1', 'oproc2', 'oproc3', 'oproc4', 'oproc5', 'oproc6', 'oproc7', 'oproc8', 'oproc9', 'oproc10', 'oproc11', 'oproc12', 'oproc13', 'oproc14', 'oproc15', 'oproc16', 'oproc17', 'oproc18', 'oproc19', 'oproc20', 'oproc21', 'oproc22', 'oproc23', 'oproc24', 'disp', 'charge', 'pay_cat', 'pay_type', 'pay_plan', 'pls_abbr', 'patcnty', 'patzip']

Whole line for first row of data:  
1,,,90046,19,1000000010,100000000009,03231995,03231995,0,0,23,23,06,06,04,F,E1,R5,,,,,,,,,,,,12132018,5,12,4,2018,12132018,12,4,2018,10,0,,1,3,3,,807,,,,Z3400,W,Z3400,N,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,31208007,20181213,0,66348005,20181213,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,999808709,999808709,00,5284,5284,999-80-8709,Y,06,1,0000,SPA,Spanish,19,90002


Selection criteria for variable of interest:
filter_variable_name='MSDRG'
is in:
filter_values=[768, 788, 807]

/home/rtullis/orchid_initiative/postpartum_larc/raw/csv_HCAIPDD_04-09-2024_1143_2018.csv
TOTAL RECORDS INPUT:   4272

/home/rtullis/orchid_initiative/postpartum_larc/created/labor_and_delivery_2018.csv
RECORDS OUTPUT IN SUBSET:   1843


 ########## RUNNING readin_and_report for 2018 ##########

Read in of subset
/home/rtullis/orchid_initiative/postpartum_larc/created/labor_and_delivery_2018.csv
           count         mean          std     min     50%      max
agyradm   1843.0    28.725448     6.390440    15.0    29.0     44.0
race_grp     0.0          NaN          NaN     NaN     NaN      NaN
dsch_yr   1843.0  2018.000000     0.000000  2018.0  2018.0   2018.0
los       1843.0     0.043950     0.205040     0.0     0.0      1.0
MSDRG     1843.0   796.089528    16.118525   768.0   807.0    807.0
charge    1843.0  8203.988606  6838.261041   767.0  6519.0  41378.0
pay_type  1843.0     1.655453     0.585850     0.0     2.0      2.0
pay_plan  1815.0    28.633058    95.374726     0.0     0.0    476.0

 MSDRG
768     405
788     227
807    1211
dtype: int64

 oshpd_id
190392       8
190429       1
190555      16
190796      42
191227       6
191228       6
NaN       1764
dtype: int64

 dsch_yr
2018    1843
dtype: int64

 ethncty
E1    870
E2    973
dtype: int64

 race1
R1      27
R2     270
R3     186
R4      31
R5    1300
R9      29
dtype: int64

 pls_abbr
ARA       4
ARM       6
CMN      65
ENG    1107
HIN       9
KOR      16
PES       8
SPA     555
TGL      41
VIE      32
dtype: int64

 pay_cat
01      35
03     860
06     748
08     108
NaN     92
dtype: int64

 pay_type
0     108
1     419
2    1316
dtype: int64

 pay_plan
0.0      1609
43.0       24
126.0      23
152.0      39
176.0      31
303.0      33
476.0      56
NaN        28
dtype: int64


 ########## RUNNING flags for 2018 ##########

prior pregnancy=
Code list
['Z3480', 'Z3481', 'Z3482', 'Z3483']

mental illness=
Code list
['F01', 'F02', 'F03', 'F04', 'F05', 'F06', 'F07', 'F09', 'F10', 'F11', 'F12', 'F13', 'F14', 'F15', 'F16', 'F17', 'F18', 'F19', 'F20', 'F21', 'F22', 'F23', 'F24', 'F25', 'F28', 'F29', 'F30', 'F31', 'F32', 'F33', 'F34', 'F39', 'F40', 'F41', 'F42', 'F43', 'F44', 'F45', 'F48', 'F50', 'F51', 'F52', 'F53', 'F54', 'F55', 'F59', 'F60', 'F63', 'F64', 'F65', 'F66', 'F68', 'F69', 'F90', 'F91', 'F93', 'F94', 'F95', 'F98', 'F99']

intellectual disability=
Code list
['F70', 'F71', 'F72', 'F73', 'F78', 'F79', 'F80', 'F81', 'F82', 'F84', 'F88', 'F89']

hemorrhage=
Code list
['O031', 'O036', 'O046', 'O071', 'O081', 'O208', 'O209', 'O4410', 'O4411', 'O4412', 'O4413', 'O4430', 'O4431', 'O4432', 'O4433', 'O4450', 'O4451', 'O4452', 'O4453', 'O46001', 'O46002', 'O46003', 'O46009', 'O46011', 'O46012', 'O46013', 'O46019', 'O46021', 'O46022', 'O46023', 'O46029', 'O46091', 'O46092', 'O46093', 'O46099', 'O468X1', 'O468X2', 'O468X3', 'O468X9', 'O4690', 'O4691', 'O4692', 'O4693', 'O670', 'O678', 'O679', 'O720', 'O721', 'O722']

intraamniotic infection=
Code list
['O411010', 'O411011', 'O411012', 'O411013', 'O411014', 'O411015', 'O411019', 'O411020', 'O411021', 'O411022', 'O411023', 'O411024', 'O411025', 'O411029', 'O411030', 'O411031', 'O411032', 'O411033', 'O411034', 'O411035', 'O411039', 'O411090', 'O411091', 'O411092', 'O411093', 'O411094', 'O411095', 'O411099']

chorioamnionitis=
Code list
['O411210', 'O411211', 'O411212', 'O411213', 'O411214', 'O411215', 'O411219', 'O411220', 'O411221', 'O411222', 'O411223', 'O411224', 'O411225', 'O411229', 'O411230', 'O411231', 'O411232', 'O411233', 'O411234', 'O411235', 'O411239', 'O411290', 'O411291', 'O411292', 'O411293', 'O411294', 'O411295', 'O411299']

endometritis=
Code list
['O8612']

Results for -- l_and_d_incl
1    1843
Name: l_and_d_incl, dtype: int64

Results for -- larc_uterine
0    1843
Name: larc_uterine, dtype: int64

Results for -- larc_subcutaneous
0    1843
Name: larc_subcutaneous, dtype: int64

Results for -- larc
0    1843
Name: larc, dtype: int64

Results for -- oshpd_id
190392        8
190429        1
190555       16
190796       42
191227        6
191228        6
unknown    1764
Name: oshpd_id, dtype: int64

Results for -- hospital_name
CEDARS-SINAI MEDICAL CENTER                   16
KAISER FOUNDATION HOSPITAL - LOS ANGELES       1
LAC/HARBOR-UCLA MEDICAL CENTER                 6
LOS ANGELES GENERAL MEDICAL CENTER             6
PIH HEALTH GOOD SAMARITAN HOSPITAL             8
RONALD REAGAN UCLA MEDICAL CENTER             42
unknown                                     1764
Name: hospital_name, dtype: int64

Results for -- age_group
0-12       0
13-19    158
20-29    812
30-45    873
46+        0
Name: age_group, dtype: int64

Results for -- ethncty
E1    870
E2    973
Name: ethncty, dtype: int64

Results for -- race1
R1      27
R2     270
R3     186
R4      31
R5    1300
R9      29
Name: race1, dtype: int64

Results for -- dsch_yr
2018    1843
Name: dsch_yr, dtype: int64

Results for -- medicaid
0    983
1    860
Name: medicaid, dtype: int64

Results for -- pay_plan_name
0                                        1609
<NA>                                       28
Aetna Health of California, Inc.           31
Blue Cross of California                   33
Blue Shield of California                  24
Cigna HealthCare of California, Inc.       39
Humana Health Plan of California           56
UHC (United Healthcare of California)      23
Name: pay_plan_name, dtype: int64

Results for -- preferred_language_not_english
0    1107
1     736
Name: preferred_language_not_english, dtype: int64

Results for -- known_prior_pregnancy
0    1843
Name: known_prior_pregnancy, dtype: int64

Results for -- mental_illness
0    1843
Name: mental_illness, dtype: int64

Results for -- intellectual_disability
0    1843
Name: intellectual_disability, dtype: int64

Results for age mapping to groups
age_group  13-19  20-29  30-45
agyradm                       
15             7      0      0
16            14      0      0
17            38      0      0
18            47      0      0
19            52      0      0
20             0     61      0
21             0     77      0
22             0     75      0
23             0     74      0
24             0     65      0
25             0     64      0
26             0    111      0
27             0     89      0
28             0     92      0
29             0    104      0
30             0      0    120
31             0      0    114
32             0      0     87
33             0      0     99
34             0      0    106
35             0      0    107
36             0      0     46
37             0      0     37
38             0      0     27
39             0      0     29
40             0      0     31
41             0      0     25
42             0      0     21
43             0      0     17
44             0      0      7



 ########## RUNNING subset_and_output for 2019 ##########

Opening input file:   /home/rtullis/orchid_initiative/postpartum_larc/raw/csv_HCAIPDD_04-09-2024_1143_2019.csv

Variables of interest are:
['oshpd_id', 'data_id', 'pat_id', 'agyradm', 'sex', 'ethncty', 'race1', 'race_grp', 'pls_abbr', 'patcnty', 'patzip', 'admtdate', 'dschdate', 'dsch_yr', 'los', 'srcpo_ns', 'srcroute_ns', 'admtype_ns', 'disp', 'pay_cat', 'pay_type', 'pay_plan', 'charge', 'MSDRG', 'diag_p', 'poa_p', 'proc_p', 'odiag1', 'odiag2', 'odiag3', 'odiag4', 'odiag5', 'odiag6', 'odiag7', 'odiag8', 'odiag9', 'odiag10', 'odiag11', 'odiag12', 'odiag13', 'odiag14', 'odiag15', 'odiag16', 'odiag17', 'odiag18', 'odiag19', 'odiag20', 'odiag21', 'odiag22', 'odiag23', 'odiag24', 'oproc1', 'oproc2', 'oproc3', 'oproc4', 'oproc5', 'oproc6', 'oproc7', 'oproc8', 'oproc9', 'oproc10', 'oproc11', 'oproc12', 'oproc13', 'oproc14', 'oproc15', 'oproc16', 'oproc17', 'oproc18', 'oproc19', 'oproc20', 'oproc21', 'oproc22', 'oproc23', 'oproc24']

Check to see if headerrow_subset and 
                         variables_keep match.
--> Good.  The headerrow_subset contains 
                             the expected variables

Here are the indices for selected variables:   [1, 5, 6, 11, 16, 17, 18, 29, 30, 35, 38, 40, 42, 43, 44, 46, 50, 51, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 103, 106, 109, 112, 115, 118, 121, 124, 127, 130, 133, 136, 139, 142, 145, 148, 151, 154, 157, 160, 163, 166, 169, 172, 201, 202, 206, 207, 208, 209, 211, 212]

And here are the corresponding variables selected:  
['oshpd_id', 'data_id', 'pat_id', 'agyradm', 'sex', 'ethncty', 'race1', 'race_grp', 'admtdate', 'dschdate', 'dsch_yr', 'los', 'srcpo_ns', 'srcroute_ns', 'admtype_ns', 'MSDRG', 'diag_p', 'poa_p', 'odiag1', 'odiag2', 'odiag3', 'odiag4', 'odiag5', 'odiag6', 'odiag7', 'odiag8', 'odiag9', 'odiag10', 'odiag11', 'odiag12', 'odiag13', 'odiag14', 'odiag15', 'odiag16', 'odiag17', 'odiag18', 'odiag19', 'odiag20', 'odiag21', 'odiag22', 'odiag23', 'odiag24', 'proc_p', 'oproc1', 'oproc2', 'oproc3', 'oproc4', 'oproc5', 'oproc6', 'oproc7', 'oproc8', 'oproc9', 'oproc10', 'oproc11', 'oproc12', 'oproc13', 'oproc14', 'oproc15', 'oproc16', 'oproc17', 'oproc18', 'oproc19', 'oproc20', 'oproc21', 'oproc22', 'oproc23', 'oproc24', 'disp', 'charge', 'pay_cat', 'pay_type', 'pay_plan', 'pls_abbr', 'patcnty', 'patzip']

Whole line for first row of data:  
1,,,91343,19,1000000003,100000000003,07291992,07291992,0,0,26,26,07,07,04,F,E2,R5,,,,,,,,,,,,07242019,4,7,3,2019,07242019,7,3,2019,3,0,,6,3,5,,768,,,,Z3400,U,Z3400,Y,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,85548006,20190724,0,66348005,20190724,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,999104954,999104954,95,7817,7817,999-10-4954,N,03,2,0000,ENG,English,19,90094


Selection criteria for variable of interest:
filter_variable_name='MSDRG'
is in:
filter_values=[768, 788, 807]

/home/rtullis/orchid_initiative/postpartum_larc/raw/csv_HCAIPDD_04-09-2024_1143_2019.csv
TOTAL RECORDS INPUT:   4311

/home/rtullis/orchid_initiative/postpartum_larc/created/labor_and_delivery_2019.csv
RECORDS OUTPUT IN SUBSET:   1906


 ########## RUNNING readin_and_report for 2019 ##########

Read in of subset
/home/rtullis/orchid_initiative/postpartum_larc/created/labor_and_delivery_2019.csv
           count         mean          std     min     50%      max
agyradm   1906.0    28.935992     6.708251    15.0    29.0     45.0
race_grp     0.0          NaN          NaN     NaN     NaN      NaN
dsch_yr   1906.0  2019.000000     0.000000  2019.0  2019.0   2019.0
los       1906.0     0.045645     0.208769     0.0     0.0      1.0
MSDRG     1906.0   795.684155    16.105164   768.0   807.0    807.0
charge    1906.0  8206.038825  6769.321140   767.0  6793.5  43955.0
pay_type  1906.0     1.663169     0.571297     0.0     2.0      2.0
pay_plan  1880.0    26.234043    91.411319     0.0     0.0    476.0

 MSDRG
768     421
788     271
807    1214
dtype: int64

 oshpd_id
190392       6
190555      12
190796      39
190878       1
191227      10
191228      10
NaN       1828
dtype: int64

 dsch_yr
2019    1906
dtype: int64

 ethncty
E1     903
E2    1003
dtype: int64

 race1
R1      23
R2     272
R3     180
R4      29
R5    1367
R9      35
dtype: int64

 pls_abbr
ARA      11
ARM      10
CMN      64
ENG    1150
HIN       8
KOR      15
PES       8
SPA     569
TGL      44
VIE      27
dtype: int64

 pay_cat
01      52
03     890
06     755
08      98
NaN    111
dtype: int64

 pay_type
0      98
1     446
2    1362
dtype: int64

 pay_plan
0.0      1672
43.0       32
126.0      41
152.0      24
176.0      33
303.0      22
476.0      56
NaN        26
dtype: int64


 ########## RUNNING flags for 2019 ##########

prior pregnancy=
Code list
['Z3480', 'Z3481', 'Z3482', 'Z3483']

mental illness=
Code list
['F01', 'F02', 'F03', 'F04', 'F05', 'F06', 'F07', 'F09', 'F10', 'F11', 'F12', 'F13', 'F14', 'F15', 'F16', 'F17', 'F18', 'F19', 'F20', 'F21', 'F22', 'F23', 'F24', 'F25', 'F28', 'F29', 'F30', 'F31', 'F32', 'F33', 'F34', 'F39', 'F40', 'F41', 'F42', 'F43', 'F44', 'F45', 'F48', 'F50', 'F51', 'F52', 'F53', 'F54', 'F55', 'F59', 'F60', 'F63', 'F64', 'F65', 'F66', 'F68', 'F69', 'F90', 'F91', 'F93', 'F94', 'F95', 'F98', 'F99']

intellectual disability=
Code list
['F70', 'F71', 'F72', 'F73', 'F78', 'F79', 'F80', 'F81', 'F82', 'F84', 'F88', 'F89']

hemorrhage=
Code list
['O031', 'O036', 'O046', 'O071', 'O081', 'O208', 'O209', 'O4410', 'O4411', 'O4412', 'O4413', 'O4430', 'O4431', 'O4432', 'O4433', 'O4450', 'O4451', 'O4452', 'O4453', 'O46001', 'O46002', 'O46003', 'O46009', 'O46011', 'O46012', 'O46013', 'O46019', 'O46021', 'O46022', 'O46023', 'O46029', 'O46091', 'O46092', 'O46093', 'O46099', 'O468X1', 'O468X2', 'O468X3', 'O468X9', 'O4690', 'O4691', 'O4692', 'O4693', 'O670', 'O678', 'O679', 'O720', 'O721', 'O722']

intraamniotic infection=
Code list
['O411010', 'O411011', 'O411012', 'O411013', 'O411014', 'O411015', 'O411019', 'O411020', 'O411021', 'O411022', 'O411023', 'O411024', 'O411025', 'O411029', 'O411030', 'O411031', 'O411032', 'O411033', 'O411034', 'O411035', 'O411039', 'O411090', 'O411091', 'O411092', 'O411093', 'O411094', 'O411095', 'O411099']

chorioamnionitis=
Code list
['O411210', 'O411211', 'O411212', 'O411213', 'O411214', 'O411215', 'O411219', 'O411220', 'O411221', 'O411222', 'O411223', 'O411224', 'O411225', 'O411229', 'O411230', 'O411231', 'O411232', 'O411233', 'O411234', 'O411235', 'O411239', 'O411290', 'O411291', 'O411292', 'O411293', 'O411294', 'O411295', 'O411299']

endometritis=
Code list
['O8612']

Results for -- l_and_d_incl
1    1906
Name: l_and_d_incl, dtype: int64

Results for -- larc_uterine
0    1905
1       1
Name: larc_uterine, dtype: int64

Results for -- larc_subcutaneous
0    1906
Name: larc_subcutaneous, dtype: int64

Results for -- larc
0    1905
1       1
Name: larc, dtype: int64

Results for -- oshpd_id
190392        6
190555       12
190796       39
190878        1
191227       10
191228       10
unknown    1828
Name: oshpd_id, dtype: int64

Results for -- hospital_name
ADVENTIST HEALTH WHITE MEMORIAL          1
CEDARS-SINAI MEDICAL CENTER             12
LAC/HARBOR-UCLA MEDICAL CENTER          10
LOS ANGELES GENERAL MEDICAL CENTER      10
PIH HEALTH GOOD SAMARITAN HOSPITAL       6
RONALD REAGAN UCLA MEDICAL CENTER       39
unknown                               1828
Name: hospital_name, dtype: int64

Results for -- age_group
0-12       0
13-19    150
20-29    850
30-45    906
46+        0
Name: age_group, dtype: int64

Results for -- ethncty
E1     903
E2    1003
Name: ethncty, dtype: int64

Results for -- race1
R1      23
R2     272
R3     180
R4      29
R5    1367
R9      35
Name: race1, dtype: int64

Results for -- dsch_yr
2019    1906
Name: dsch_yr, dtype: int64

Results for -- medicaid
0    1016
1     890
Name: medicaid, dtype: int64

Results for -- pay_plan_name
0                                        1672
<NA>                                       26
Aetna Health of California, Inc.           33
Blue Cross of California                   22
Blue Shield of California                  32
Cigna HealthCare of California, Inc.       24
Humana Health Plan of California           56
UHC (United Healthcare of California)      41
Name: pay_plan_name, dtype: int64

Results for -- preferred_language_not_english
0    1150
1     756
Name: preferred_language_not_english, dtype: int64

Results for -- known_prior_pregnancy
0    1906
Name: known_prior_pregnancy, dtype: int64

Results for -- mental_illness
0    1906
Name: mental_illness, dtype: int64

Results for -- intellectual_disability
0    1906
Name: intellectual_disability, dtype: int64

Results for age mapping to groups
age_group  13-19  20-29  30-45
agyradm                       
15             4      0      0
16            22      0      0
17            34      0      0
18            42      0      0
19            48      0      0
20             0     78      0
21             0     81      0
22             0     83      0
23             0     70      0
24             0     85      0
25             0     63      0
26             0     85      0
27             0    106      0
28             0     97      0
29             0    102      0
30             0      0    109
31             0      0    110
32             0      0    113
33             0      0     99
34             0      0    103
35             0      0     94
36             0      0     42
37             0      0     32
38             0      0     26
39             0      0     29
40             0      0     29
41             0      0     33
42             0      0     28
43             0      0     23
44             0      0     32
45             0      0      4



 ########## RUNNING subset_and_output for 2020 ##########

Opening input file:   /home/rtullis/orchid_initiative/postpartum_larc/raw/csv_HCAIPDD_04-09-2024_1143_2020.csv

Variables of interest are:
['oshpd_id', 'data_id', 'pat_id', 'agyradm', 'sex', 'ethncty', 'race1', 'race_grp', 'pls_abbr', 'patcnty', 'patzip', 'admtdate', 'dschdate', 'dsch_yr', 'los', 'srcpo_ns', 'srcroute_ns', 'admtype_ns', 'disp', 'pay_cat', 'pay_type', 'pay_plan', 'charge', 'MSDRG', 'diag_p', 'poa_p', 'proc_p', 'odiag1', 'odiag2', 'odiag3', 'odiag4', 'odiag5', 'odiag6', 'odiag7', 'odiag8', 'odiag9', 'odiag10', 'odiag11', 'odiag12', 'odiag13', 'odiag14', 'odiag15', 'odiag16', 'odiag17', 'odiag18', 'odiag19', 'odiag20', 'odiag21', 'odiag22', 'odiag23', 'odiag24', 'oproc1', 'oproc2', 'oproc3', 'oproc4', 'oproc5', 'oproc6', 'oproc7', 'oproc8', 'oproc9', 'oproc10', 'oproc11', 'oproc12', 'oproc13', 'oproc14', 'oproc15', 'oproc16', 'oproc17', 'oproc18', 'oproc19', 'oproc20', 'oproc21', 'oproc22', 'oproc23', 'oproc24']

Check to see if headerrow_subset and 
                         variables_keep match.
--> Good.  The headerrow_subset contains 
                             the expected variables

Here are the indices for selected variables:   [1, 5, 6, 11, 16, 17, 18, 29, 30, 35, 38, 40, 42, 43, 44, 46, 50, 51, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 103, 106, 109, 112, 115, 118, 121, 124, 127, 130, 133, 136, 139, 142, 145, 148, 151, 154, 157, 160, 163, 166, 169, 172, 201, 202, 206, 207, 208, 209, 211, 212]

And here are the corresponding variables selected:  
['oshpd_id', 'data_id', 'pat_id', 'agyradm', 'sex', 'ethncty', 'race1', 'race_grp', 'admtdate', 'dschdate', 'dsch_yr', 'los', 'srcpo_ns', 'srcroute_ns', 'admtype_ns', 'MSDRG', 'diag_p', 'poa_p', 'odiag1', 'odiag2', 'odiag3', 'odiag4', 'odiag5', 'odiag6', 'odiag7', 'odiag8', 'odiag9', 'odiag10', 'odiag11', 'odiag12', 'odiag13', 'odiag14', 'odiag15', 'odiag16', 'odiag17', 'odiag18', 'odiag19', 'odiag20', 'odiag21', 'odiag22', 'odiag23', 'odiag24', 'proc_p', 'oproc1', 'oproc2', 'oproc3', 'oproc4', 'oproc5', 'oproc6', 'oproc7', 'oproc8', 'oproc9', 'oproc10', 'oproc11', 'oproc12', 'oproc13', 'oproc14', 'oproc15', 'oproc16', 'oproc17', 'oproc18', 'oproc19', 'oproc20', 'oproc21', 'oproc22', 'oproc23', 'oproc24', 'disp', 'charge', 'pay_cat', 'pay_type', 'pay_plan', 'pls_abbr', 'patcnty', 'patzip']

Whole line for first row of data:  
1,,,90036,19,1000000007,100000000006,11251990,11251990,0,0,29,29,07,07,04,F,E1,R5,,,,,,,,,,,,08302020,1,8,3,2020,08302020,8,3,2020,7,0,,F,3,5,,807,,,,Z3400,N,Z3400,W,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,31208007,20200830,0,66348005,20200830,0,0UH97HZ,20200830,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,999851560,999851560,89,20035,20035,999-85-1560,N,06,2,0000,ENG,English,19,90810


Selection criteria for variable of interest:
filter_variable_name='MSDRG'
is in:
filter_values=[768, 788, 807]

/home/rtullis/orchid_initiative/postpartum_larc/raw/csv_HCAIPDD_04-09-2024_1143_2020.csv
TOTAL RECORDS INPUT:   4271

/home/rtullis/orchid_initiative/postpartum_larc/created/labor_and_delivery_2020.csv
RECORDS OUTPUT IN SUBSET:   1967


 ########## RUNNING readin_and_report for 2020 ##########

Read in of subset
/home/rtullis/orchid_initiative/postpartum_larc/created/labor_and_delivery_2020.csv
           count         mean          std     min     50%      max
agyradm   1967.0    29.072191     6.718650    15.0    29.0     45.0
race_grp     0.0          NaN          NaN     NaN     NaN      NaN
dsch_yr   1967.0  2020.000000     0.000000  2020.0  2020.0   2020.0
los       1967.0     0.040671     0.197577     0.0     0.0      1.0
MSDRG     1967.0   796.054398    15.976063   768.0   807.0    807.0
charge    1967.0  8000.147433  6577.070614   767.0  6705.0  41536.0
pay_type  1967.0     1.667514     0.579645     0.0     2.0      2.0
pay_plan  1939.0    26.412584    92.110144     0.0     0.0    476.0

 MSDRG
768     421
788     269
807    1277
dtype: int64

 oshpd_id
190392       7
190429       1
190555       6
190796      32
190878       4
191227       8
191228       4
NaN       1905
dtype: int64

 dsch_yr
2020    1967
dtype: int64

 ethncty
E1     932
E2    1035
dtype: int64

 race1
R1      27
R2     293
R3     161
R4      44
R5    1417
R9      25
dtype: int64

 pls_abbr
ARA       9
ARM      12
CMN      62
ENG    1185
HIN      10
KOR      24
PES      10
SPA     600
TGL      28
VIE      27
dtype: int64

 pay_cat
01      61
03     922
06     765
08     112
NaN    107
dtype: int64

 pay_type
0     112
1     430
2    1425
dtype: int64

 pay_plan
0.0      1728
43.0       32
126.0      32
152.0      32
176.0      31
303.0      26
476.0      58
NaN        28
dtype: int64


 ########## RUNNING flags for 2020 ##########

prior pregnancy=
Code list
['Z3480', 'Z3481', 'Z3482', 'Z3483']

mental illness=
Code list
['F01', 'F02', 'F03', 'F04', 'F05', 'F06', 'F07', 'F09', 'F10', 'F11', 'F12', 'F13', 'F14', 'F15', 'F16', 'F17', 'F18', 'F19', 'F20', 'F21', 'F22', 'F23', 'F24', 'F25', 'F28', 'F29', 'F30', 'F31', 'F32', 'F33', 'F34', 'F39', 'F40', 'F41', 'F42', 'F43', 'F44', 'F45', 'F48', 'F50', 'F51', 'F52', 'F53', 'F54', 'F55', 'F59', 'F60', 'F63', 'F64', 'F65', 'F66', 'F68', 'F69', 'F90', 'F91', 'F93', 'F94', 'F95', 'F98', 'F99']

intellectual disability=
Code list
['F70', 'F71', 'F72', 'F73', 'F78', 'F79', 'F80', 'F81', 'F82', 'F84', 'F88', 'F89']

hemorrhage=
Code list
['O031', 'O036', 'O046', 'O071', 'O081', 'O208', 'O209', 'O4410', 'O4411', 'O4412', 'O4413', 'O4430', 'O4431', 'O4432', 'O4433', 'O4450', 'O4451', 'O4452', 'O4453', 'O46001', 'O46002', 'O46003', 'O46009', 'O46011', 'O46012', 'O46013', 'O46019', 'O46021', 'O46022', 'O46023', 'O46029', 'O46091', 'O46092', 'O46093', 'O46099', 'O468X1', 'O468X2', 'O468X3', 'O468X9', 'O4690', 'O4691', 'O4692', 'O4693', 'O670', 'O678', 'O679', 'O720', 'O721', 'O722']

intraamniotic infection=
Code list
['O411010', 'O411011', 'O411012', 'O411013', 'O411014', 'O411015', 'O411019', 'O411020', 'O411021', 'O411022', 'O411023', 'O411024', 'O411025', 'O411029', 'O411030', 'O411031', 'O411032', 'O411033', 'O411034', 'O411035', 'O411039', 'O411090', 'O411091', 'O411092', 'O411093', 'O411094', 'O411095', 'O411099']

chorioamnionitis=
Code list
['O411210', 'O411211', 'O411212', 'O411213', 'O411214', 'O411215', 'O411219', 'O411220', 'O411221', 'O411222', 'O411223', 'O411224', 'O411225', 'O411229', 'O411230', 'O411231', 'O411232', 'O411233', 'O411234', 'O411235', 'O411239', 'O411290', 'O411291', 'O411292', 'O411293', 'O411294', 'O411295', 'O411299']

endometritis=
Code list
['O8612']

Results for -- l_and_d_incl
1    1967
Name: l_and_d_incl, dtype: int64

Results for -- larc_uterine
0    1967
Name: larc_uterine, dtype: int64

Results for -- larc_subcutaneous
0    1966
1       1
Name: larc_subcutaneous, dtype: int64

Results for -- larc
0    1966
1       1
Name: larc, dtype: int64

Results for -- oshpd_id
190392        7
190429        1
190555        6
190796       32
190878        4
191227        8
191228        4
unknown    1905
Name: oshpd_id, dtype: int64

Results for -- hospital_name
ADVENTIST HEALTH WHITE MEMORIAL                4
CEDARS-SINAI MEDICAL CENTER                    6
KAISER FOUNDATION HOSPITAL - LOS ANGELES       1
LAC/HARBOR-UCLA MEDICAL CENTER                 8
LOS ANGELES GENERAL MEDICAL CENTER             4
PIH HEALTH GOOD SAMARITAN HOSPITAL             7
RONALD REAGAN UCLA MEDICAL CENTER             32
unknown                                     1905
Name: hospital_name, dtype: int64

Results for -- age_group
0-12       0
13-19    154
20-29    886
30-45    927
46+        0
Name: age_group, dtype: int64

Results for -- ethncty
E1     932
E2    1035
Name: ethncty, dtype: int64

Results for -- race1
R1      27
R2     293
R3     161
R4      44
R5    1417
R9      25
Name: race1, dtype: int64

Results for -- dsch_yr
2020    1967
Name: dsch_yr, dtype: int64

Results for -- medicaid
0    1045
1     922
Name: medicaid, dtype: int64

Results for -- pay_plan_name
0                                        1728
<NA>                                       28
Aetna Health of California, Inc.           31
Blue Cross of California                   26
Blue Shield of California                  32
Cigna HealthCare of California, Inc.       32
Humana Health Plan of California           58
UHC (United Healthcare of California)      32
Name: pay_plan_name, dtype: int64

Results for -- preferred_language_not_english
0    1185
1     782
Name: preferred_language_not_english, dtype: int64

Results for -- known_prior_pregnancy
0    1967
Name: known_prior_pregnancy, dtype: int64

Results for -- mental_illness
0    1967
Name: mental_illness, dtype: int64

Results for -- intellectual_disability
0    1967
Name: intellectual_disability, dtype: int64

Results for age mapping to groups
age_group  13-19  20-29  30-45
agyradm                       
15             6      0      0
16            19      0      0
17            37      0      0
18            35      0      0
19            57      0      0
20             0     85      0
21             0     73      0
22             0     59      0
23             0     92      0
24             0     66      0
25             0     74      0
26             0    101      0
27             0     94      0
28             0    119      0
29             0    123      0
30             0      0    116
31             0      0     92
32             0      0     97
33             0      0    120
34             0      0    111
35             0      0     95
36             0      0     44
37             0      0     35
38             0      0     35
39             0      0     41
40             0      0     19
41             0      0     18
42             0      0     32
43             0      0     27
44             0      0     26
45             0      0     19



 ########## RUNNING subset_and_output for 2021 ##########

Opening input file:   /home/rtullis/orchid_initiative/postpartum_larc/raw/csv_HCAIPDD_04-09-2024_1143_2021.csv

Variables of interest are:
['oshpd_id', 'data_id', 'pat_id', 'agyradm', 'sex', 'ethncty', 'race1', 'race_grp', 'pls_abbr', 'patcnty', 'patzip', 'admtdate', 'dschdate', 'dsch_yr', 'los', 'srcpo_ns', 'srcroute_ns', 'admtype_ns', 'disp', 'pay_cat', 'pay_type', 'pay_plan', 'charge', 'MSDRG', 'diag_p', 'poa_p', 'proc_p', 'odiag1', 'odiag2', 'odiag3', 'odiag4', 'odiag5', 'odiag6', 'odiag7', 'odiag8', 'odiag9', 'odiag10', 'odiag11', 'odiag12', 'odiag13', 'odiag14', 'odiag15', 'odiag16', 'odiag17', 'odiag18', 'odiag19', 'odiag20', 'odiag21', 'odiag22', 'odiag23', 'odiag24', 'oproc1', 'oproc2', 'oproc3', 'oproc4', 'oproc5', 'oproc6', 'oproc7', 'oproc8', 'oproc9', 'oproc10', 'oproc11', 'oproc12', 'oproc13', 'oproc14', 'oproc15', 'oproc16', 'oproc17', 'oproc18', 'oproc19', 'oproc20', 'oproc21', 'oproc22', 'oproc23', 'oproc24']

Check to see if headerrow_subset and 
                         variables_keep match.
--> Good.  The headerrow_subset contains 
                             the expected variables

Here are the indices for selected variables:   [1, 5, 6, 11, 16, 17, 18, 29, 30, 35, 38, 40, 42, 43, 44, 46, 50, 51, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 103, 106, 109, 112, 115, 118, 121, 124, 127, 130, 133, 136, 139, 142, 145, 148, 151, 154, 157, 160, 163, 166, 169, 172, 201, 202, 206, 207, 208, 209, 211, 212]

And here are the corresponding variables selected:  
['oshpd_id', 'data_id', 'pat_id', 'agyradm', 'sex', 'ethncty', 'race1', 'race_grp', 'admtdate', 'dschdate', 'dsch_yr', 'los', 'srcpo_ns', 'srcroute_ns', 'admtype_ns', 'MSDRG', 'diag_p', 'poa_p', 'odiag1', 'odiag2', 'odiag3', 'odiag4', 'odiag5', 'odiag6', 'odiag7', 'odiag8', 'odiag9', 'odiag10', 'odiag11', 'odiag12', 'odiag13', 'odiag14', 'odiag15', 'odiag16', 'odiag17', 'odiag18', 'odiag19', 'odiag20', 'odiag21', 'odiag22', 'odiag23', 'odiag24', 'proc_p', 'oproc1', 'oproc2', 'oproc3', 'oproc4', 'oproc5', 'oproc6', 'oproc7', 'oproc8', 'oproc9', 'oproc10', 'oproc11', 'oproc12', 'oproc13', 'oproc14', 'oproc15', 'oproc16', 'oproc17', 'oproc18', 'oproc19', 'oproc20', 'oproc21', 'oproc22', 'oproc23', 'oproc24', 'disp', 'charge', 'pay_cat', 'pay_type', 'pay_plan', 'pls_abbr', 'patcnty', 'patzip']

Whole line for first row of data:  
1,,,90270,19,1000000001,100000000001,07131998,07131998,0,0,22,22,06,06,04,F,E2,R2,,,,,,,,,,,,03292021,2,3,1,2021,03292021,3,1,2021,1,0,,D,3,5,,768,,,,Z3400,U,Z3400,N,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,85548006,20210329,0,66348005,20210329,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,999807564,999807564,51,9460,9460,999-80-7564,Y,06,2,0000,ENG,English,19,90232


Selection criteria for variable of interest:
filter_variable_name='MSDRG'
is in:
filter_values=[768, 788, 807]

/home/rtullis/orchid_initiative/postpartum_larc/raw/csv_HCAIPDD_04-09-2024_1143_2021.csv
TOTAL RECORDS INPUT:   4242

/home/rtullis/orchid_initiative/postpartum_larc/created/labor_and_delivery_2021.csv
RECORDS OUTPUT IN SUBSET:   1951


 ########## RUNNING readin_and_report for 2021 ##########

Read in of subset
/home/rtullis/orchid_initiative/postpartum_larc/created/labor_and_delivery_2021.csv
           count         mean          std     min     50%      max
agyradm   1951.0    29.353152     6.917376    15.0    29.0     47.0
race_grp     0.0          NaN          NaN     NaN     NaN      NaN
dsch_yr   1951.0  2021.000000     0.000000  2021.0  2021.0   2021.0
los       1951.0     0.042030     0.200708     0.0     0.0      1.0
MSDRG     1951.0   795.546899    16.409745   768.0   807.0    807.0
charge    1951.0  8053.847770  6426.254177   767.0  6717.0  40413.0
pay_type  1951.0     1.666325     0.573687     0.0     2.0      2.0
pay_plan  1920.0    32.352083   105.658431     0.0     0.0    476.0

 MSDRG
768     457
788     238
807    1256
dtype: int64

 oshpd_id
190392       6
190555       8
190796      27
190878       1
191227      17
191228       5
NaN       1887
dtype: int64

 dsch_yr
2021    1951
dtype: int64

 ethncty
E1     951
E2    1000
dtype: int64

 race1
R1      20
R2     298
R3     188
R4      37
R5    1374
R9      34
dtype: int64

 pls_abbr
ARA      14
ARM      11
CMN      52
ENG    1169
HIN      11
KOR      25
PES      14
SPA     584
TGL      42
VIE      29
dtype: int64

 pay_cat
01      40
03     929
06     755
08     104
NaN    123
dtype: int64

 pay_type
0     104
1     443
2    1404
dtype: int64

 pay_plan
0.0      1697
43.0       26
126.0      33
152.0      20
176.0      33
303.0      28
476.0      83
NaN        31
dtype: int64


 ########## RUNNING flags for 2021 ##########

prior pregnancy=
Code list
['Z3480', 'Z3481', 'Z3482', 'Z3483']

mental illness=
Code list
['F01', 'F02', 'F03', 'F04', 'F05', 'F06', 'F07', 'F09', 'F10', 'F11', 'F12', 'F13', 'F14', 'F15', 'F16', 'F17', 'F18', 'F19', 'F20', 'F21', 'F22', 'F23', 'F24', 'F25', 'F28', 'F29', 'F30', 'F31', 'F32', 'F33', 'F34', 'F39', 'F40', 'F41', 'F42', 'F43', 'F44', 'F45', 'F48', 'F50', 'F51', 'F52', 'F53', 'F54', 'F55', 'F59', 'F60', 'F63', 'F64', 'F65', 'F66', 'F68', 'F69', 'F90', 'F91', 'F93', 'F94', 'F95', 'F98', 'F99']

intellectual disability=
Code list
['F70', 'F71', 'F72', 'F73', 'F78', 'F79', 'F80', 'F81', 'F82', 'F84', 'F88', 'F89']

hemorrhage=
Code list
['O031', 'O036', 'O046', 'O071', 'O081', 'O208', 'O209', 'O4410', 'O4411', 'O4412', 'O4413', 'O4430', 'O4431', 'O4432', 'O4433', 'O4450', 'O4451', 'O4452', 'O4453', 'O46001', 'O46002', 'O46003', 'O46009', 'O46011', 'O46012', 'O46013', 'O46019', 'O46021', 'O46022', 'O46023', 'O46029', 'O46091', 'O46092', 'O46093', 'O46099', 'O468X1', 'O468X2', 'O468X3', 'O468X9', 'O4690', 'O4691', 'O4692', 'O4693', 'O670', 'O678', 'O679', 'O720', 'O721', 'O722']

intraamniotic infection=
Code list
['O411010', 'O411011', 'O411012', 'O411013', 'O411014', 'O411015', 'O411019', 'O411020', 'O411021', 'O411022', 'O411023', 'O411024', 'O411025', 'O411029', 'O411030', 'O411031', 'O411032', 'O411033', 'O411034', 'O411035', 'O411039', 'O411090', 'O411091', 'O411092', 'O411093', 'O411094', 'O411095', 'O411099']

chorioamnionitis=
Code list
['O411210', 'O411211', 'O411212', 'O411213', 'O411214', 'O411215', 'O411219', 'O411220', 'O411221', 'O411222', 'O411223', 'O411224', 'O411225', 'O411229', 'O411230', 'O411231', 'O411232', 'O411233', 'O411234', 'O411235', 'O411239', 'O411290', 'O411291', 'O411292', 'O411293', 'O411294', 'O411295', 'O411299']

endometritis=
Code list
['O8612']

Results for -- l_and_d_incl
1    1951
Name: l_and_d_incl, dtype: int64

Results for -- larc_uterine
0    1951
Name: larc_uterine, dtype: int64

Results for -- larc_subcutaneous
0    1951
Name: larc_subcutaneous, dtype: int64

Results for -- larc
0    1951
Name: larc, dtype: int64

Results for -- oshpd_id
190392        6
190555        8
190796       27
190878        1
191227       17
191228        5
unknown    1887
Name: oshpd_id, dtype: int64

Results for -- hospital_name
ADVENTIST HEALTH WHITE MEMORIAL          1
CEDARS-SINAI MEDICAL CENTER              8
LAC/HARBOR-UCLA MEDICAL CENTER          17
LOS ANGELES GENERAL MEDICAL CENTER       5
PIH HEALTH GOOD SAMARITAN HOSPITAL       6
RONALD REAGAN UCLA MEDICAL CENTER       27
unknown                               1887
Name: hospital_name, dtype: int64

Results for -- age_group
0-12       0
13-19    148
20-29    854
30-45    922
46+       27
Name: age_group, dtype: int64

Results for -- ethncty
E1     951
E2    1000
Name: ethncty, dtype: int64

Results for -- race1
R1      20
R2     298
R3     188
R4      37
R5    1374
R9      34
Name: race1, dtype: int64

Results for -- dsch_yr
2021    1951
Name: dsch_yr, dtype: int64

Results for -- medicaid
0    1022
1     929
Name: medicaid, dtype: int64

Results for -- pay_plan_name
0                                        1697
<NA>                                       31
Aetna Health of California, Inc.           33
Blue Cross of California                   28
Blue Shield of California                  26
Cigna HealthCare of California, Inc.       20
Humana Health Plan of California           83
UHC (United Healthcare of California)      33
Name: pay_plan_name, dtype: int64

Results for -- preferred_language_not_english
0    1169
1     782
Name: preferred_language_not_english, dtype: int64

Results for -- known_prior_pregnancy
0    1951
Name: known_prior_pregnancy, dtype: int64

Results for -- mental_illness
0    1951
Name: mental_illness, dtype: int64

Results for -- intellectual_disability
0    1951
Name: intellectual_disability, dtype: int64

Results for age mapping to groups
age_group  13-19  20-29  30-45  46+
agyradm                            
15             2      0      0    0
16            17      0      0    0
17            43      0      0    0
18            33      0      0    0
19            53      0      0    0
20             0     56      0    0
21             0     93      0    0
22             0     69      0    0
23             0     78      0    0
24             0     76      0    0
25             0     78      0    0
26             0     93      0    0
27             0     98      0    0
28             0    122      0    0
29             0     91      0    0
30             0      0    104    0
31             0      0     96    0
32             0      0    104    0
33             0      0    101    0
34             0      0    114    0
35             0      0    115    0
36             0      0     39    0
37             0      0     32    0
38             0      0     47    0
39             0      0     36    0
40             0      0     28    0
41             0      0     29    0
42             0      0     14    0
43             0      0     15    0
44             0      0     27    0
45             0      0     21    0
46             0      0      0   24
47             0      0      0    3



 ########## RUNNING subset_and_output for 2022 ##########

Opening input file:   /home/rtullis/orchid_initiative/postpartum_larc/raw/csv_HCAIPDD_04-09-2024_1143_2022.csv

Variables of interest are:
['oshpd_id', 'data_id', 'pat_id', 'agyradm', 'sex', 'ethncty', 'race1', 'race_grp', 'pls_abbr', 'patcnty', 'patzip', 'admtdate', 'dschdate', 'dsch_yr', 'los', 'srcpo_ns', 'srcroute_ns', 'admtype_ns', 'disp', 'pay_cat', 'pay_type', 'pay_plan', 'charge', 'MSDRG', 'diag_p', 'poa_p', 'proc_p', 'odiag1', 'odiag2', 'odiag3', 'odiag4', 'odiag5', 'odiag6', 'odiag7', 'odiag8', 'odiag9', 'odiag10', 'odiag11', 'odiag12', 'odiag13', 'odiag14', 'odiag15', 'odiag16', 'odiag17', 'odiag18', 'odiag19', 'odiag20', 'odiag21', 'odiag22', 'odiag23', 'odiag24', 'oproc1', 'oproc2', 'oproc3', 'oproc4', 'oproc5', 'oproc6', 'oproc7', 'oproc8', 'oproc9', 'oproc10', 'oproc11', 'oproc12', 'oproc13', 'oproc14', 'oproc15', 'oproc16', 'oproc17', 'oproc18', 'oproc19', 'oproc20', 'oproc21', 'oproc22', 'oproc23', 'oproc24']

Check to see if headerrow_subset and 
                         variables_keep match.
--> Good.  The headerrow_subset contains 
                             the expected variables

Here are the indices for selected variables:   [1, 5, 6, 11, 16, 17, 18, 29, 30, 35, 38, 40, 42, 43, 44, 46, 50, 51, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 103, 106, 109, 112, 115, 118, 121, 124, 127, 130, 133, 136, 139, 142, 145, 148, 151, 154, 157, 160, 163, 166, 169, 172, 201, 202, 206, 207, 208, 209, 211, 212]

And here are the corresponding variables selected:  
['oshpd_id', 'data_id', 'pat_id', 'agyradm', 'sex', 'ethncty', 'race1', 'race_grp', 'admtdate', 'dschdate', 'dsch_yr', 'los', 'srcpo_ns', 'srcroute_ns', 'admtype_ns', 'MSDRG', 'diag_p', 'poa_p', 'odiag1', 'odiag2', 'odiag3', 'odiag4', 'odiag5', 'odiag6', 'odiag7', 'odiag8', 'odiag9', 'odiag10', 'odiag11', 'odiag12', 'odiag13', 'odiag14', 'odiag15', 'odiag16', 'odiag17', 'odiag18', 'odiag19', 'odiag20', 'odiag21', 'odiag22', 'odiag23', 'odiag24', 'proc_p', 'oproc1', 'oproc2', 'oproc3', 'oproc4', 'oproc5', 'oproc6', 'oproc7', 'oproc8', 'oproc9', 'oproc10', 'oproc11', 'oproc12', 'oproc13', 'oproc14', 'oproc15', 'oproc16', 'oproc17', 'oproc18', 'oproc19', 'oproc20', 'oproc21', 'oproc22', 'oproc23', 'oproc24', 'disp', 'charge', 'pay_cat', 'pay_type', 'pay_plan', 'pls_abbr', 'patcnty', 'patzip']

Whole line for first row of data:  
1,,,90211,19,1000000002,100000000002,01152002,01152002,0,0,20,20,06,06,04,F,E1,R1,,,,,,,,,,,,10112022,3,10,4,2022,10112022,10,4,2022,2,0,,5,3,4,,788,,,,Z3400,N,Z3400,U,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,237001001,20221011,0,11466000,20221011,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,999655425,999655425,07,13648,13648,999-65-5425,N,06,2,0000,ENG,English,19,90059


Selection criteria for variable of interest:
filter_variable_name='MSDRG'
is in:
filter_values=[768, 788, 807]

/home/rtullis/orchid_initiative/postpartum_larc/raw/csv_HCAIPDD_04-09-2024_1143_2022.csv
TOTAL RECORDS INPUT:   4161

/home/rtullis/orchid_initiative/postpartum_larc/created/labor_and_delivery_2022.csv
RECORDS OUTPUT IN SUBSET:   1920


 ########## RUNNING readin_and_report for 2022 ##########

Read in of subset
/home/rtullis/orchid_initiative/postpartum_larc/created/labor_and_delivery_2022.csv
           count         mean          std     min     50%      max
agyradm   1920.0    29.309375     7.222303    15.0    29.0     48.0
race_grp     0.0          NaN          NaN     NaN     NaN      NaN
dsch_yr   1920.0  2022.000000     0.000000  2022.0  2022.0   2022.0
los       1920.0     0.032292     0.176820     0.0     0.0      1.0
MSDRG     1920.0   795.765104    16.112894   768.0   807.0    807.0
charge    1920.0  8028.672917  6680.532512   767.0  6466.5  45685.0
pay_type  1920.0     1.652604     0.587913     0.0     2.0      2.0
pay_plan  1894.0    27.526399    93.612508     0.0     0.0    476.0

 MSDRG
768     424
788     265
807    1231
dtype: int64

 oshpd_id
190392       9
190429       1
190555      11
190796      37
190878       2
191227       6
191228       4
NaN       1850
dtype: int64

 dsch_yr
2022    1920
dtype: int64

 ethncty
E1     909
E2    1011
dtype: int64

 race1
R1      28
R2     291
R3     193
R4      33
R5    1348
R9      27
dtype: int64

 pls_abbr
ARA      11
ARM      11
CMN      52
ENG    1171
HIN       9
KOR      18
PES       8
SPA     571
TGL      41
VIE      28
dtype: int64

 pay_cat
01      48
03     887
06     764
08     114
NaN    107
dtype: int64

 pay_type
0     114
1     439
2    1367
dtype: int64

 pay_plan
0.0      1683
43.0       28
126.0      37
152.0      28
176.0      27
303.0      35
476.0      56
NaN        26
dtype: int64


 ########## RUNNING flags for 2022 ##########

prior pregnancy=
Code list
['Z3480', 'Z3481', 'Z3482', 'Z3483']

mental illness=
Code list
['F01', 'F02', 'F03', 'F04', 'F05', 'F06', 'F07', 'F09', 'F10', 'F11', 'F12', 'F13', 'F14', 'F15', 'F16', 'F17', 'F18', 'F19', 'F20', 'F21', 'F22', 'F23', 'F24', 'F25', 'F28', 'F29', 'F30', 'F31', 'F32', 'F33', 'F34', 'F39', 'F40', 'F41', 'F42', 'F43', 'F44', 'F45', 'F48', 'F50', 'F51', 'F52', 'F53', 'F54', 'F55', 'F59', 'F60', 'F63', 'F64', 'F65', 'F66', 'F68', 'F69', 'F90', 'F91', 'F93', 'F94', 'F95', 'F98', 'F99']

intellectual disability=
Code list
['F70', 'F71', 'F72', 'F73', 'F78', 'F79', 'F80', 'F81', 'F82', 'F84', 'F88', 'F89']

hemorrhage=
Code list
['O031', 'O036', 'O046', 'O071', 'O081', 'O208', 'O209', 'O4410', 'O4411', 'O4412', 'O4413', 'O4430', 'O4431', 'O4432', 'O4433', 'O4450', 'O4451', 'O4452', 'O4453', 'O46001', 'O46002', 'O46003', 'O46009', 'O46011', 'O46012', 'O46013', 'O46019', 'O46021', 'O46022', 'O46023', 'O46029', 'O46091', 'O46092', 'O46093', 'O46099', 'O468X1', 'O468X2', 'O468X3', 'O468X9', 'O4690', 'O4691', 'O4692', 'O4693', 'O670', 'O678', 'O679', 'O720', 'O721', 'O722']

intraamniotic infection=
Code list
['O411010', 'O411011', 'O411012', 'O411013', 'O411014', 'O411015', 'O411019', 'O411020', 'O411021', 'O411022', 'O411023', 'O411024', 'O411025', 'O411029', 'O411030', 'O411031', 'O411032', 'O411033', 'O411034', 'O411035', 'O411039', 'O411090', 'O411091', 'O411092', 'O411093', 'O411094', 'O411095', 'O411099']

chorioamnionitis=
Code list
['O411210', 'O411211', 'O411212', 'O411213', 'O411214', 'O411215', 'O411219', 'O411220', 'O411221', 'O411222', 'O411223', 'O411224', 'O411225', 'O411229', 'O411230', 'O411231', 'O411232', 'O411233', 'O411234', 'O411235', 'O411239', 'O411290', 'O411291', 'O411292', 'O411293', 'O411294', 'O411295', 'O411299']

endometritis=
Code list
['O8612']

Results for -- l_and_d_incl
1    1920
Name: l_and_d_incl, dtype: int64

Results for -- larc_uterine
0    1920
Name: larc_uterine, dtype: int64

Results for -- larc_subcutaneous
0    1920
Name: larc_subcutaneous, dtype: int64

Results for -- larc
0    1920
Name: larc, dtype: int64

Results for -- oshpd_id
190392        9
190429        1
190555       11
190796       37
190878        2
191227        6
191228        4
unknown    1850
Name: oshpd_id, dtype: int64

Results for -- hospital_name
ADVENTIST HEALTH WHITE MEMORIAL                2
CEDARS-SINAI MEDICAL CENTER                   11
KAISER FOUNDATION HOSPITAL - LOS ANGELES       1
LAC/HARBOR-UCLA MEDICAL CENTER                 6
LOS ANGELES GENERAL MEDICAL CENTER             4
PIH HEALTH GOOD SAMARITAN HOSPITAL             9
RONALD REAGAN UCLA MEDICAL CENTER             37
unknown                                     1850
Name: hospital_name, dtype: int64

Results for -- age_group
0-12       0
13-19    159
20-29    854
30-45    867
46+       40
Name: age_group, dtype: int64

Results for -- ethncty
E1     909
E2    1011
Name: ethncty, dtype: int64

Results for -- race1
R1      28
R2     291
R3     193
R4      33
R5    1348
R9      27
Name: race1, dtype: int64

Results for -- dsch_yr
2022    1920
Name: dsch_yr, dtype: int64

Results for -- medicaid
0    1033
1     887
Name: medicaid, dtype: int64

Results for -- pay_plan_name
0                                        1683
<NA>                                       26
Aetna Health of California, Inc.           27
Blue Cross of California                   35
Blue Shield of California                  28
Cigna HealthCare of California, Inc.       28
Humana Health Plan of California           56
UHC (United Healthcare of California)      37
Name: pay_plan_name, dtype: int64

Results for -- preferred_language_not_english
0    1171
1     749
Name: preferred_language_not_english, dtype: int64

Results for -- known_prior_pregnancy
0    1920
Name: known_prior_pregnancy, dtype: int64

Results for -- mental_illness
0    1920
Name: mental_illness, dtype: int64

Results for -- intellectual_disability
0    1920
Name: intellectual_disability, dtype: int64

Results for age mapping to groups
age_group  13-19  20-29  30-45  46+
agyradm                            
15             6      0      0    0
16            18      0      0    0
17            33      0      0    0
18            45      0      0    0
19            57      0      0    0
20             0     77      0    0
21             0     79      0    0
22             0     68      0    0
23             0     63      0    0
24             0     69      0    0
25             0     78      0    0
26             0     95      0    0
27             0    114      0    0
28             0    114      0    0
29             0     97      0    0
30             0      0    119    0
31             0      0     97    0
32             0      0     88    0
33             0      0     97    0
34             0      0     88    0
35             0      0    107    0
36             0      0     37    0
37             0      0     23    0
38             0      0     26    0
39             0      0     25    0
40             0      0     34    0
41             0      0     22    0
42             0      0     27    0
43             0      0     20    0
44             0      0     29    0
45             0      0     28    0
46             0      0      0   17
47             0      0      0   16
48             0      0      0    7



 ########## RUNNING subset_and_output for 2023 ##########

Opening input file:   /home/rtullis/orchid_initiative/postpartum_larc/raw/csv_HCAIPDD_04-09-2024_1143_2023.csv

Variables of interest are:
['oshpd_id', 'data_id', 'pat_id', 'agyradm', 'sex', 'ethncty', 'race1', 'race_grp', 'pls_abbr', 'patcnty', 'patzip', 'admtdate', 'dschdate', 'dsch_yr', 'los', 'srcpo_ns', 'srcroute_ns', 'admtype_ns', 'disp', 'pay_cat', 'pay_type', 'pay_plan', 'charge', 'MSDRG', 'diag_p', 'poa_p', 'proc_p', 'odiag1', 'odiag2', 'odiag3', 'odiag4', 'odiag5', 'odiag6', 'odiag7', 'odiag8', 'odiag9', 'odiag10', 'odiag11', 'odiag12', 'odiag13', 'odiag14', 'odiag15', 'odiag16', 'odiag17', 'odiag18', 'odiag19', 'odiag20', 'odiag21', 'odiag22', 'odiag23', 'odiag24', 'oproc1', 'oproc2', 'oproc3', 'oproc4', 'oproc5', 'oproc6', 'oproc7', 'oproc8', 'oproc9', 'oproc10', 'oproc11', 'oproc12', 'oproc13', 'oproc14', 'oproc15', 'oproc16', 'oproc17', 'oproc18', 'oproc19', 'oproc20', 'oproc21', 'oproc22', 'oproc23', 'oproc24']

Check to see if headerrow_subset and 
                         variables_keep match.
--> Good.  The headerrow_subset contains 
                             the expected variables

Here are the indices for selected variables:   [1, 5, 6, 11, 16, 17, 18, 29, 30, 35, 38, 40, 42, 43, 44, 46, 50, 51, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 103, 106, 109, 112, 115, 118, 121, 124, 127, 130, 133, 136, 139, 142, 145, 148, 151, 154, 157, 160, 163, 166, 169, 172, 201, 202, 206, 207, 208, 209, 211, 212]

And here are the corresponding variables selected:  
['oshpd_id', 'data_id', 'pat_id', 'agyradm', 'sex', 'ethncty', 'race1', 'race_grp', 'admtdate', 'dschdate', 'dsch_yr', 'los', 'srcpo_ns', 'srcroute_ns', 'admtype_ns', 'MSDRG', 'diag_p', 'poa_p', 'odiag1', 'odiag2', 'odiag3', 'odiag4', 'odiag5', 'odiag6', 'odiag7', 'odiag8', 'odiag9', 'odiag10', 'odiag11', 'odiag12', 'odiag13', 'odiag14', 'odiag15', 'odiag16', 'odiag17', 'odiag18', 'odiag19', 'odiag20', 'odiag21', 'odiag22', 'odiag23', 'odiag24', 'proc_p', 'oproc1', 'oproc2', 'oproc3', 'oproc4', 'oproc5', 'oproc6', 'oproc7', 'oproc8', 'oproc9', 'oproc10', 'oproc11', 'oproc12', 'oproc13', 'oproc14', 'oproc15', 'oproc16', 'oproc17', 'oproc18', 'oproc19', 'oproc20', 'oproc21', 'oproc22', 'oproc23', 'oproc24', 'disp', 'charge', 'pay_cat', 'pay_type', 'pay_plan', 'pls_abbr', 'patcnty', 'patzip']

Whole line for first row of data:  
1,190796,106190796,90095,19,1000000006,100000000005,10242004,10242004,0,0,18,18,05,05,03,F,E1,R5,,,,,,,,,,,,05222023,2,5,2,2023,05222023,5,2,2023,6,0,,E,3,5,,807,,,,Z3400,Y,Z3400,N,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,18946005,20230522,0,66348005,20230522,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,999211674,999211674,20,4978,4978,999-21-1674,Y,06,2,0000,ENG,English,19,91405


Selection criteria for variable of interest:
filter_variable_name='MSDRG'
is in:
filter_values=[768, 788, 807]

/home/rtullis/orchid_initiative/postpartum_larc/raw/csv_HCAIPDD_04-09-2024_1143_2023.csv
TOTAL RECORDS INPUT:   4183

/home/rtullis/orchid_initiative/postpartum_larc/created/labor_and_delivery_2023.csv
RECORDS OUTPUT IN SUBSET:   2036


 ########## RUNNING readin_and_report for 2023 ##########

Read in of subset
/home/rtullis/orchid_initiative/postpartum_larc/created/labor_and_delivery_2023.csv
           count         mean          std     min     50%      max
agyradm   2036.0    29.264735     7.212748    15.0    29.0     49.0
race_grp     0.0          NaN          NaN     NaN     NaN      NaN
dsch_yr   2036.0  2023.000000     0.000000  2023.0  2023.0   2023.0
los       2036.0     0.042731     0.202299     0.0     0.0      1.0
MSDRG     2036.0   795.312377    16.228184   768.0   807.0    807.0
charge    2036.0  8178.967583  6566.354615   767.0  6859.0  43360.0
pay_type  2036.0     1.655206     0.593145     0.0     2.0      2.0
pay_plan  2017.0    25.791274    91.724979     0.0     0.0    476.0

 MSDRG
768     464
788     300
807    1272
dtype: int64

 oshpd_id
190392      17
190429       1
190555      15
190796      40
190878       2
191227       7
191228       9
NaN       1945
dtype: int64

 dsch_yr
2023    2036
dtype: int64

 ethncty
E1    1002
E2    1034
dtype: int64

 race1
R1      31
R2     311
R3     167
R4      34
R5    1453
R9      40
dtype: int64

 pls_abbr
ARA      15
ARM       6
CMN      62
ENG    1197
HIN       8
KOR      15
PES      13
SPA     642
TGL      41
VIE      37
dtype: int64

 pay_cat
01      43
03     929
06     817
08     128
NaN    119
dtype: int64

 pay_type
0     128
1     446
2    1462
dtype: int64

 pay_plan
0.0      1801
43.0       37
126.0      42
152.0      24
176.0      26
303.0      26
476.0      61
NaN        19
dtype: int64


 ########## RUNNING flags for 2023 ##########

prior pregnancy=
Code list
['Z3480', 'Z3481', 'Z3482', 'Z3483']

mental illness=
Code list
['F01', 'F02', 'F03', 'F04', 'F05', 'F06', 'F07', 'F09', 'F10', 'F11', 'F12', 'F13', 'F14', 'F15', 'F16', 'F17', 'F18', 'F19', 'F20', 'F21', 'F22', 'F23', 'F24', 'F25', 'F28', 'F29', 'F30', 'F31', 'F32', 'F33', 'F34', 'F39', 'F40', 'F41', 'F42', 'F43', 'F44', 'F45', 'F48', 'F50', 'F51', 'F52', 'F53', 'F54', 'F55', 'F59', 'F60', 'F63', 'F64', 'F65', 'F66', 'F68', 'F69', 'F90', 'F91', 'F93', 'F94', 'F95', 'F98', 'F99']

intellectual disability=
Code list
['F70', 'F71', 'F72', 'F73', 'F78', 'F79', 'F80', 'F81', 'F82', 'F84', 'F88', 'F89']

hemorrhage=
Code list
['O031', 'O036', 'O046', 'O071', 'O081', 'O208', 'O209', 'O4410', 'O4411', 'O4412', 'O4413', 'O4430', 'O4431', 'O4432', 'O4433', 'O4450', 'O4451', 'O4452', 'O4453', 'O46001', 'O46002', 'O46003', 'O46009', 'O46011', 'O46012', 'O46013', 'O46019', 'O46021', 'O46022', 'O46023', 'O46029', 'O46091', 'O46092', 'O46093', 'O46099', 'O468X1', 'O468X2', 'O468X3', 'O468X9', 'O4690', 'O4691', 'O4692', 'O4693', 'O670', 'O678', 'O679', 'O720', 'O721', 'O722']

intraamniotic infection=
Code list
['O411010', 'O411011', 'O411012', 'O411013', 'O411014', 'O411015', 'O411019', 'O411020', 'O411021', 'O411022', 'O411023', 'O411024', 'O411025', 'O411029', 'O411030', 'O411031', 'O411032', 'O411033', 'O411034', 'O411035', 'O411039', 'O411090', 'O411091', 'O411092', 'O411093', 'O411094', 'O411095', 'O411099']

chorioamnionitis=
Code list
['O411210', 'O411211', 'O411212', 'O411213', 'O411214', 'O411215', 'O411219', 'O411220', 'O411221', 'O411222', 'O411223', 'O411224', 'O411225', 'O411229', 'O411230', 'O411231', 'O411232', 'O411233', 'O411234', 'O411235', 'O411239', 'O411290', 'O411291', 'O411292', 'O411293', 'O411294', 'O411295', 'O411299']

endometritis=
Code list
['O8612']

Results for -- l_and_d_incl
1    2036
Name: l_and_d_incl, dtype: int64

Results for -- larc_uterine
0    2036
Name: larc_uterine, dtype: int64

Results for -- larc_subcutaneous
0    2036
Name: larc_subcutaneous, dtype: int64

Results for -- larc
0    2036
Name: larc, dtype: int64

Results for -- oshpd_id
190392       17
190429        1
190555       15
190796       40
190878        2
191227        7
191228        9
unknown    1945
Name: oshpd_id, dtype: int64

Results for -- hospital_name
ADVENTIST HEALTH WHITE MEMORIAL                2
CEDARS-SINAI MEDICAL CENTER                   15
KAISER FOUNDATION HOSPITAL - LOS ANGELES       1
LAC/HARBOR-UCLA MEDICAL CENTER                 7
LOS ANGELES GENERAL MEDICAL CENTER             9
PIH HEALTH GOOD SAMARITAN HOSPITAL            17
RONALD REAGAN UCLA MEDICAL CENTER             40
unknown                                     1945
Name: hospital_name, dtype: int64

Results for -- age_group
0-12       0
13-19    166
20-29    925
30-45    885
46+       60
Name: age_group, dtype: int64

Results for -- ethncty
E1    1002
E2    1034
Name: ethncty, dtype: int64

Results for -- race1
R1      31
R2     311
R3     167
R4      34
R5    1453
R9      40
Name: race1, dtype: int64

Results for -- dsch_yr
2023    2036
Name: dsch_yr, dtype: int64

Results for -- medicaid
0    1107
1     929
Name: medicaid, dtype: int64

Results for -- pay_plan_name
0                                        1801
<NA>                                       19
Aetna Health of California, Inc.           26
Blue Cross of California                   26
Blue Shield of California                  37
Cigna HealthCare of California, Inc.       24
Humana Health Plan of California           61
UHC (United Healthcare of California)      42
Name: pay_plan_name, dtype: int64

Results for -- preferred_language_not_english
0    1197
1     839
Name: preferred_language_not_english, dtype: int64

Results for -- known_prior_pregnancy
0    2036
Name: known_prior_pregnancy, dtype: int64

Results for -- mental_illness
0    2036
Name: mental_illness, dtype: int64

Results for -- intellectual_disability
0    2036
Name: intellectual_disability, dtype: int64

Results for age mapping to groups
age_group  13-19  20-29  30-45  46+
agyradm                            
15             1      0      0    0
16            31      0      0    0
17            32      0      0    0
18            35      0      0    0
19            67      0      0    0
20             0     70      0    0
21             0     69      0    0
22             0     87      0    0
23             0     80      0    0
24             0     89      0    0
25             0     82      0    0
26             0     98      0    0
27             0    113      0    0
28             0    128      0    0
29             0    109      0    0
30             0      0    112    0
31             0      0    116    0
32             0      0    101    0
33             0      0    112    0
34             0      0     78    0
35             0      0     98    0
36             0      0     41    0
37             0      0     34    0
38             0      0     23    0
39             0      0     32    0
40             0      0     32    0
41             0      0     22    0
42             0      0     21    0
43             0      0     22    0
44             0      0     18    0
45             0      0     23    0
46             0      0      0   17
47             0      0      0   17
48             0      0      0   22
49             0      0      0    4



 ########## RUNNING subset_and_output for 2024 ##########

Opening input file:   /home/rtullis/orchid_initiative/postpartum_larc/raw/csv_HCAIPDD_04-09-2024_1143_2024.csv

Variables of interest are:
['oshpd_id', 'data_id', 'pat_id', 'agyradm', 'sex', 'ethncty', 'race1', 'race_grp', 'pls_abbr', 'patcnty', 'patzip', 'admtdate', 'dschdate', 'dsch_yr', 'los', 'srcpo_ns', 'srcroute_ns', 'admtype_ns', 'disp', 'pay_cat', 'pay_type', 'pay_plan', 'charge', 'MSDRG', 'diag_p', 'poa_p', 'proc_p', 'odiag1', 'odiag2', 'odiag3', 'odiag4', 'odiag5', 'odiag6', 'odiag7', 'odiag8', 'odiag9', 'odiag10', 'odiag11', 'odiag12', 'odiag13', 'odiag14', 'odiag15', 'odiag16', 'odiag17', 'odiag18', 'odiag19', 'odiag20', 'odiag21', 'odiag22', 'odiag23', 'odiag24', 'oproc1', 'oproc2', 'oproc3', 'oproc4', 'oproc5', 'oproc6', 'oproc7', 'oproc8', 'oproc9', 'oproc10', 'oproc11', 'oproc12', 'oproc13', 'oproc14', 'oproc15', 'oproc16', 'oproc17', 'oproc18', 'oproc19', 'oproc20', 'oproc21', 'oproc22', 'oproc23', 'oproc24']

Check to see if headerrow_subset and 
                         variables_keep match.
--> Good.  The headerrow_subset contains 
                             the expected variables

Here are the indices for selected variables:   [1, 5, 6, 11, 16, 17, 18, 29, 30, 35, 38, 40, 42, 43, 44, 46, 50, 51, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 103, 106, 109, 112, 115, 118, 121, 124, 127, 130, 133, 136, 139, 142, 145, 148, 151, 154, 157, 160, 163, 166, 169, 172, 201, 202, 206, 207, 208, 209, 211, 212]

And here are the corresponding variables selected:  
['oshpd_id', 'data_id', 'pat_id', 'agyradm', 'sex', 'ethncty', 'race1', 'race_grp', 'admtdate', 'dschdate', 'dsch_yr', 'los', 'srcpo_ns', 'srcroute_ns', 'admtype_ns', 'MSDRG', 'diag_p', 'poa_p', 'odiag1', 'odiag2', 'odiag3', 'odiag4', 'odiag5', 'odiag6', 'odiag7', 'odiag8', 'odiag9', 'odiag10', 'odiag11', 'odiag12', 'odiag13', 'odiag14', 'odiag15', 'odiag16', 'odiag17', 'odiag18', 'odiag19', 'odiag20', 'odiag21', 'odiag22', 'odiag23', 'odiag24', 'proc_p', 'oproc1', 'oproc2', 'oproc3', 'oproc4', 'oproc5', 'oproc6', 'oproc7', 'oproc8', 'oproc9', 'oproc10', 'oproc11', 'oproc12', 'oproc13', 'oproc14', 'oproc15', 'oproc16', 'oproc17', 'oproc18', 'oproc19', 'oproc20', 'oproc21', 'oproc22', 'oproc23', 'oproc24', 'disp', 'charge', 'pay_cat', 'pay_type', 'pay_plan', 'pls_abbr', 'patcnty', 'patzip']

Whole line for first row of data:  
1,190796,106190796,90095,19,1000000012,100000000010,07221990,07221990,0,0,33,33,08,08,05,F,E1,R2,,,,,,,,,,,,01072024,1,1,1,2024,01072024,1,1,2024,12,0,,E,3,5,,807,,,,Z3400,N,Z3400,Y,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,18946005,20240107,0,66348005,20240107,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,999519568,999519568,95,4511,4511,999-51-9568,Y,06,2,0000,ENG,English,19,90008


Selection criteria for variable of interest:
filter_variable_name='MSDRG'
is in:
filter_values=[768, 788, 807]

/home/rtullis/orchid_initiative/postpartum_larc/raw/csv_HCAIPDD_04-09-2024_1143_2024.csv
TOTAL RECORDS INPUT:   1007

/home/rtullis/orchid_initiative/postpartum_larc/created/labor_and_delivery_2024.csv
RECORDS OUTPUT IN SUBSET:   481


 ########## RUNNING readin_and_report for 2024 ##########

Read in of subset
/home/rtullis/orchid_initiative/postpartum_larc/created/labor_and_delivery_2024.csv
          count         mean          std     min     50%      max
agyradm   481.0    30.099792     7.526787    16.0    30.0     49.0
race_grp    0.0          NaN          NaN     NaN     NaN      NaN
dsch_yr   481.0  2024.000000     0.000000  2024.0  2024.0   2024.0
los       481.0     0.043659     0.204548     0.0     0.0      1.0
MSDRG     481.0   795.151767    16.387109   768.0   807.0    807.0
charge    481.0  8571.627859  6881.291375   767.0  7028.0  34766.0
pay_type  481.0     1.702703     0.529320     0.0     2.0      2.0
pay_plan  474.0    34.795359   107.679082     0.0     0.0    476.0

 MSDRG
768    113
788     68
807    300
dtype: int64

 oshpd_id
190392      1
190555      4
190796     11
190878      2
191227      3
191228      2
NaN       458
dtype: int64

 dsch_yr
2024    481
dtype: int64

 ethncty
E1    219
E2    262
dtype: int64

 race1
R1      5
R2     77
R3     53
R4     10
R5    328
R9      8
dtype: int64

 pls_abbr
ARA      2
ARM      3
CMN     10
ENG    277
HIN      5
KOR      4
PES      3
SPA    149
TGL     11
VIE     17
dtype: int64

 pay_cat
01      14
03     244
06     165
08      17
NaN     41
dtype: int64

 pay_type
0     17
1    109
2    355
dtype: int64

 pay_plan
0.0      414
43.0       6
126.0      9
152.0      9
176.0      5
303.0     11
476.0     20
NaN        7
dtype: int64


 ########## RUNNING flags for 2024 ##########

prior pregnancy=
Code list
['Z3480', 'Z3481', 'Z3482', 'Z3483']

mental illness=
Code list
['F01', 'F02', 'F03', 'F04', 'F05', 'F06', 'F07', 'F09', 'F10', 'F11', 'F12', 'F13', 'F14', 'F15', 'F16', 'F17', 'F18', 'F19', 'F20', 'F21', 'F22', 'F23', 'F24', 'F25', 'F28', 'F29', 'F30', 'F31', 'F32', 'F33', 'F34', 'F39', 'F40', 'F41', 'F42', 'F43', 'F44', 'F45', 'F48', 'F50', 'F51', 'F52', 'F53', 'F54', 'F55', 'F59', 'F60', 'F63', 'F64', 'F65', 'F66', 'F68', 'F69', 'F90', 'F91', 'F93', 'F94', 'F95', 'F98', 'F99']

intellectual disability=
Code list
['F70', 'F71', 'F72', 'F73', 'F78', 'F79', 'F80', 'F81', 'F82', 'F84', 'F88', 'F89']

hemorrhage=
Code list
['O031', 'O036', 'O046', 'O071', 'O081', 'O208', 'O209', 'O4410', 'O4411', 'O4412', 'O4413', 'O4430', 'O4431', 'O4432', 'O4433', 'O4450', 'O4451', 'O4452', 'O4453', 'O46001', 'O46002', 'O46003', 'O46009', 'O46011', 'O46012', 'O46013', 'O46019', 'O46021', 'O46022', 'O46023', 'O46029', 'O46091', 'O46092', 'O46093', 'O46099', 'O468X1', 'O468X2', 'O468X3', 'O468X9', 'O4690', 'O4691', 'O4692', 'O4693', 'O670', 'O678', 'O679', 'O720', 'O721', 'O722']

intraamniotic infection=
Code list
['O411010', 'O411011', 'O411012', 'O411013', 'O411014', 'O411015', 'O411019', 'O411020', 'O411021', 'O411022', 'O411023', 'O411024', 'O411025', 'O411029', 'O411030', 'O411031', 'O411032', 'O411033', 'O411034', 'O411035', 'O411039', 'O411090', 'O411091', 'O411092', 'O411093', 'O411094', 'O411095', 'O411099']

chorioamnionitis=
Code list
['O411210', 'O411211', 'O411212', 'O411213', 'O411214', 'O411215', 'O411219', 'O411220', 'O411221', 'O411222', 'O411223', 'O411224', 'O411225', 'O411229', 'O411230', 'O411231', 'O411232', 'O411233', 'O411234', 'O411235', 'O411239', 'O411290', 'O411291', 'O411292', 'O411293', 'O411294', 'O411295', 'O411299']

endometritis=
Code list
['O8612']

Results for -- l_and_d_incl
1    481
Name: l_and_d_incl, dtype: int64

Results for -- larc_uterine
0    481
Name: larc_uterine, dtype: int64

Results for -- larc_subcutaneous
0    481
Name: larc_subcutaneous, dtype: int64

Results for -- larc
0    481
Name: larc, dtype: int64

Results for -- oshpd_id
190392       1
190555       4
190796      11
190878       2
191227       3
191228       2
unknown    458
Name: oshpd_id, dtype: int64

Results for -- hospital_name
ADVENTIST HEALTH WHITE MEMORIAL         2
CEDARS-SINAI MEDICAL CENTER             4
LAC/HARBOR-UCLA MEDICAL CENTER          3
LOS ANGELES GENERAL MEDICAL CENTER      2
PIH HEALTH GOOD SAMARITAN HOSPITAL      1
RONALD REAGAN UCLA MEDICAL CENTER      11
unknown                               458
Name: hospital_name, dtype: int64

Results for -- age_group
0-12       0
13-19     34
20-29    195
30-45    232
46+       20
Name: age_group, dtype: int64

Results for -- ethncty
E1    219
E2    262
Name: ethncty, dtype: int64

Results for -- race1
R1      5
R2     77
R3     53
R4     10
R5    328
R9      8
Name: race1, dtype: int64

Results for -- dsch_yr
2024    481
Name: dsch_yr, dtype: int64

Results for -- medicaid
0    237
1    244
Name: medicaid, dtype: int64

Results for -- pay_plan_name
0                                        414
<NA>                                       7
Aetna Health of California, Inc.           5
Blue Cross of California                  11
Blue Shield of California                  6
Cigna HealthCare of California, Inc.       9
Humana Health Plan of California          20
UHC (United Healthcare of California)      9
Name: pay_plan_name, dtype: int64

Results for -- preferred_language_not_english
0    277
1    204
Name: preferred_language_not_english, dtype: int64

Results for -- known_prior_pregnancy
0    481
Name: known_prior_pregnancy, dtype: int64

Results for -- mental_illness
0    481
Name: mental_illness, dtype: int64

Results for -- intellectual_disability
0    481
Name: intellectual_disability, dtype: int64

Results for age mapping to groups
age_group  13-19  20-29  30-45  46+
agyradm                            
16             7      0      0    0
17             6      0      0    0
18            12      0      0    0
19             9      0      0    0
20             0     21      0    0
21             0     11      0    0
22             0     24      0    0
23             0      8      0    0
24             0     18      0    0
25             0     17      0    0
26             0     22      0    0
27             0     32      0    0
28             0     22      0    0
29             0     20      0    0
30             0      0     22    0
31             0      0     25    0
32             0      0     27    0
33             0      0     32    0
34             0      0     30    0
35             0      0     29    0
36             0      0     10    0
37             0      0     10    0
38             0      0     10    0
39             0      0      4    0
40             0      0      3    0
41             0      0      5    0
42             0      0      2    0
43             0      0     10    0
44             0      0      6    0
45             0      0      7    0
46             0      0      0    4
47             0      0      0    5
48             0      0      0    7
49             0      0      0    4



 ########## RUNNING subset_and_output for test ##########

Opening input file:   /home/rtullis/orchid_initiative/postpartum_larc/raw/csv_HCAIPDD_04-09-2024_1143_2024_test.csv

Variables of interest are:
['oshpd_id', 'data_id', 'pat_id', 'agyradm', 'sex', 'ethncty', 'race1', 'race_grp', 'pls_abbr', 'patcnty', 'patzip', 'admtdate', 'dschdate', 'dsch_yr', 'los', 'srcpo_ns', 'srcroute_ns', 'admtype_ns', 'disp', 'pay_cat', 'pay_type', 'pay_plan', 'charge', 'MSDRG', 'diag_p', 'poa_p', 'proc_p', 'odiag1', 'odiag2', 'odiag3', 'odiag4', 'odiag5', 'odiag6', 'odiag7', 'odiag8', 'odiag9', 'odiag10', 'odiag11', 'odiag12', 'odiag13', 'odiag14', 'odiag15', 'odiag16', 'odiag17', 'odiag18', 'odiag19', 'odiag20', 'odiag21', 'odiag22', 'odiag23', 'odiag24', 'oproc1', 'oproc2', 'oproc3', 'oproc4', 'oproc5', 'oproc6', 'oproc7', 'oproc8', 'oproc9', 'oproc10', 'oproc11', 'oproc12', 'oproc13', 'oproc14', 'oproc15', 'oproc16', 'oproc17', 'oproc18', 'oproc19', 'oproc20', 'oproc21', 'oproc22', 'oproc23', 'oproc24']

Check to see if headerrow_subset and 
                         variables_keep match.
--> Good.  The headerrow_subset contains 
                             the expected variables

Here are the indices for selected variables:   [1, 5, 6, 11, 16, 17, 18, 29, 30, 35, 38, 40, 42, 43, 44, 46, 50, 51, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 103, 106, 109, 112, 115, 118, 121, 124, 127, 130, 133, 136, 139, 142, 145, 148, 151, 154, 157, 160, 163, 166, 169, 172, 201, 202, 206, 207, 208, 209, 211, 212]

And here are the corresponding variables selected:  
['oshpd_id', 'data_id', 'pat_id', 'agyradm', 'sex', 'ethncty', 'race1', 'race_grp', 'admtdate', 'dschdate', 'dsch_yr', 'los', 'srcpo_ns', 'srcroute_ns', 'admtype_ns', 'MSDRG', 'diag_p', 'poa_p', 'odiag1', 'odiag2', 'odiag3', 'odiag4', 'odiag5', 'odiag6', 'odiag7', 'odiag8', 'odiag9', 'odiag10', 'odiag11', 'odiag12', 'odiag13', 'odiag14', 'odiag15', 'odiag16', 'odiag17', 'odiag18', 'odiag19', 'odiag20', 'odiag21', 'odiag22', 'odiag23', 'odiag24', 'proc_p', 'oproc1', 'oproc2', 'oproc3', 'oproc4', 'oproc5', 'oproc6', 'oproc7', 'oproc8', 'oproc9', 'oproc10', 'oproc11', 'oproc12', 'oproc13', 'oproc14', 'oproc15', 'oproc16', 'oproc17', 'oproc18', 'oproc19', 'oproc20', 'oproc21', 'oproc22', 'oproc23', 'oproc24', 'disp', 'charge', 'pay_cat', 'pay_type', 'pay_plan', 'pls_abbr', 'patcnty', 'patzip']

Whole line for first row of data:  
1,190796,106190796,90095,19,1000000012,100000000010,07221990,07221990,0,0,33,33,08,08,05,F,E1,R2,,,,,,,,,,,,01072024,1,1,1,2024,01072024,1,1,2024,12,0,,E,3,5,,807,,,,Z3400,N,Z3400,Y,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,18946005,20240107,0,65200003,20240107,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,999519568,999519568,95,4511,4511,999-51-9568,Y,06,2,0000,ENG,English,19,90008


Selection criteria for variable of interest:
filter_variable_name='MSDRG'
is in:
filter_values=[768, 788, 807]

/home/rtullis/orchid_initiative/postpartum_larc/raw/csv_HCAIPDD_04-09-2024_1143_2024_test.csv
TOTAL RECORDS INPUT:   1007

/home/rtullis/orchid_initiative/postpartum_larc/created/labor_and_delivery_test.csv
RECORDS OUTPUT IN SUBSET:   481


 ########## RUNNING readin_and_report for test ##########

Read in of subset
/home/rtullis/orchid_initiative/postpartum_larc/created/labor_and_delivery_test.csv
          count         mean          std     min     50%      max
agyradm   481.0    30.099792     7.526787    16.0    30.0     49.0
race_grp    0.0          NaN          NaN     NaN     NaN      NaN
dsch_yr   481.0  2024.000000     0.000000  2024.0  2024.0   2024.0
los       481.0     0.043659     0.204548     0.0     0.0      1.0
MSDRG     481.0   795.151767    16.387109   768.0   807.0    807.0
charge    481.0  8571.627859  6881.291375   767.0  7028.0  34766.0
pay_type  481.0     1.702703     0.529320     0.0     2.0      2.0
pay_plan  474.0    34.795359   107.679082     0.0     0.0    476.0

 MSDRG
768    113
788     68
807    300
dtype: int64

 oshpd_id
190392      1
190555      4
190796     11
190878      2
191227      3
191228      2
NaN       458
dtype: int64

 dsch_yr
2024    481
dtype: int64

 ethncty
E1    219
E2    262
dtype: int64

 race1
R1      5
R2     77
R3     53
R4     10
R5    328
R9      8
dtype: int64

 pls_abbr
ARA      2
ARM      3
CMN     10
ENG    277
HIN      5
KOR      4
PES      3
SPA    149
TGL     11
VIE     17
dtype: int64

 pay_cat
01      14
03     244
06     165
08      17
NaN     41
dtype: int64

 pay_type
0     17
1    109
2    355
dtype: int64

 pay_plan
0.0      414
43.0       6
126.0      9
152.0      9
176.0      5
303.0     11
476.0     20
NaN        7
dtype: int64


 ########## RUNNING flags for test ##########

prior pregnancy=
Code list
['Z3480', 'Z3481', 'Z3482', 'Z3483']

mental illness=
Code list
['F01', 'F02', 'F03', 'F04', 'F05', 'F06', 'F07', 'F09', 'F10', 'F11', 'F12', 'F13', 'F14', 'F15', 'F16', 'F17', 'F18', 'F19', 'F20', 'F21', 'F22', 'F23', 'F24', 'F25', 'F28', 'F29', 'F30', 'F31', 'F32', 'F33', 'F34', 'F39', 'F40', 'F41', 'F42', 'F43', 'F44', 'F45', 'F48', 'F50', 'F51', 'F52', 'F53', 'F54', 'F55', 'F59', 'F60', 'F63', 'F64', 'F65', 'F66', 'F68', 'F69', 'F90', 'F91', 'F93', 'F94', 'F95', 'F98', 'F99']

intellectual disability=
Code list
['F70', 'F71', 'F72', 'F73', 'F78', 'F79', 'F80', 'F81', 'F82', 'F84', 'F88', 'F89']

hemorrhage=
Code list
['O031', 'O036', 'O046', 'O071', 'O081', 'O208', 'O209', 'O4410', 'O4411', 'O4412', 'O4413', 'O4430', 'O4431', 'O4432', 'O4433', 'O4450', 'O4451', 'O4452', 'O4453', 'O46001', 'O46002', 'O46003', 'O46009', 'O46011', 'O46012', 'O46013', 'O46019', 'O46021', 'O46022', 'O46023', 'O46029', 'O46091', 'O46092', 'O46093', 'O46099', 'O468X1', 'O468X2', 'O468X3', 'O468X9', 'O4690', 'O4691', 'O4692', 'O4693', 'O670', 'O678', 'O679', 'O720', 'O721', 'O722']

intraamniotic infection=
Code list
['O411010', 'O411011', 'O411012', 'O411013', 'O411014', 'O411015', 'O411019', 'O411020', 'O411021', 'O411022', 'O411023', 'O411024', 'O411025', 'O411029', 'O411030', 'O411031', 'O411032', 'O411033', 'O411034', 'O411035', 'O411039', 'O411090', 'O411091', 'O411092', 'O411093', 'O411094', 'O411095', 'O411099']

chorioamnionitis=
Code list
['O411210', 'O411211', 'O411212', 'O411213', 'O411214', 'O411215', 'O411219', 'O411220', 'O411221', 'O411222', 'O411223', 'O411224', 'O411225', 'O411229', 'O411230', 'O411231', 'O411232', 'O411233', 'O411234', 'O411235', 'O411239', 'O411290', 'O411291', 'O411292', 'O411293', 'O411294', 'O411295', 'O411299']

endometritis=
Code list
['O8612']

Results for -- l_and_d_incl
0      4
1    477
Name: l_and_d_incl, dtype: int64

Results for -- larc_uterine
0    480
1      1
Name: larc_uterine, dtype: int64

Results for -- larc_subcutaneous
0    480
1      1
Name: larc_subcutaneous, dtype: int64

Results for -- larc
0    479
1      2
Name: larc, dtype: int64

Results for -- oshpd_id
190392       1
190555       4
190796      11
190878       2
191227       3
191228       2
unknown    458
Name: oshpd_id, dtype: int64

Results for -- hospital_name
ADVENTIST HEALTH WHITE MEMORIAL         2
CEDARS-SINAI MEDICAL CENTER             4
LAC/HARBOR-UCLA MEDICAL CENTER          3
LOS ANGELES GENERAL MEDICAL CENTER      2
PIH HEALTH GOOD SAMARITAN HOSPITAL      1
RONALD REAGAN UCLA MEDICAL CENTER      11
unknown                               458
Name: hospital_name, dtype: int64

Results for -- age_group
0-12       0
13-19     34
20-29    195
30-45    232
46+       20
Name: age_group, dtype: int64

Results for -- ethncty
E1    219
E2    262
Name: ethncty, dtype: int64

Results for -- race1
R1      5
R2     77
R3     53
R4     10
R5    328
R9      8
Name: race1, dtype: int64

Results for -- dsch_yr
2024    481
Name: dsch_yr, dtype: int64

Results for -- medicaid
0    237
1    244
Name: medicaid, dtype: int64

Results for -- pay_plan_name
0                                        414
<NA>                                       7
Aetna Health of California, Inc.           5
Blue Cross of California                  11
Blue Shield of California                  6
Cigna HealthCare of California, Inc.       9
Humana Health Plan of California          20
UHC (United Healthcare of California)      9
Name: pay_plan_name, dtype: int64

Results for -- preferred_language_not_english
0    277
1    204
Name: preferred_language_not_english, dtype: int64

Results for -- known_prior_pregnancy
0    480
1      1
Name: known_prior_pregnancy, dtype: int64

Results for -- mental_illness
0    479
1      2
Name: mental_illness, dtype: int64

Results for -- intellectual_disability
0    479
1      2
Name: intellectual_disability, dtype: int64

Results for age mapping to groups
age_group  13-19  20-29  30-45  46+
agyradm                            
16             7      0      0    0
17             6      0      0    0
18            12      0      0    0
19             9      0      0    0
20             0     21      0    0
21             0     11      0    0
22             0     24      0    0
23             0      8      0    0
24             0     18      0    0
25             0     17      0    0
26             0     22      0    0
27             0     32      0    0
28             0     22      0    0
29             0     20      0    0
30             0      0     22    0
31             0      0     25    0
32             0      0     27    0
33             0      0     32    0
34             0      0     30    0
35             0      0     29    0
36             0      0     10    0
37             0      0     10    0
38             0      0     10    0
39             0      0      4    0
40             0      0      3    0
41             0      0      5    0
42             0      0      2    0
43             0      0     10    0
44             0      0      6    0
45             0      0      7    0
46             0      0      0    4
47             0      0      0    5
48             0      0      0    7
49             0      0      0    4


Elapsed time (seconds):   20.481765747070312
